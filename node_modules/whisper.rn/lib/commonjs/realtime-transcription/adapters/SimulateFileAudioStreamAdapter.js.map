{"version":3,"names":["_WavFileReader","require","SimulateFileAudioStreamAdapter","config","isInitialized","recording","currentBytePosition","startTime","pausedTime","hasReachedEnd","constructor","options","playbackSpeed","chunkDurationMs","loop","logger","fileReader","WavFileReader","fs","filePath","initialize","release","header","getHeader","Error","sampleRate","log","channels","bitsPerSample","duration","toFixed","error","_this$errorCallback","errorMessage","message","errorCallback","call","start","_this$statusCallback","Date","now","statusCallback","startStreaming","_this$statusCallback2","_this$errorCallback2","stop","_this$statusCallback3","streamInterval","clearInterval","undefined","_this$errorCallback3","isRecording","onData","callback","dataCallback","onError","onStatusChange","_this$errorCallback4","chunkDurationSec","bytesPerSecond","chunkSizeBytes","Math","floor","intervalMs","setInterval","streamNextChunk","_this$errorCallback5","audioChunk","getAudioSlice","length","onEndOfFile","streamData","data","timestamp","getStatistics","currentTime","byteToTime","totalDuration","progress","totalBytes","getTotalDataSize","seekToTime","timeSeconds","clampedTime","max","min","timeToByte","setPlaybackSpeed","speed","then","resetBuffer","_this$options$logger","_this$options","exports"],"sourceRoot":"../../../../src","sources":["realtime-transcription/adapters/SimulateFileAudioStreamAdapter.ts"],"mappings":"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"}