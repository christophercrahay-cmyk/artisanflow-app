{"version":3,"names":["_common","require","WavFileWriter","dataSize","isWriting","writeQueue","constructor","fs","filePath","config","initialize","header","createWavHeader","writeFile","uint8ArrayToBase64","error","Error","appendAudioData","audioData","push","processWriteQueue","console","warn","length","totalLength","reduce","sum","data","combinedData","Uint8Array","offset","forEach","set","base64Data","appendFile","finalize","currentData","readFile","currentBytes","base64ToUint8Array","correctHeader","finalData","slice","finalBase64","ArrayBuffer","view","DataView","setUint32","setUint16","channels","sampleRate","bitsPerSample","cancel","exists","unlink","getStatistics","durationSec","queuedChunks","estimatedFileSizeMB","exports"],"sourceRoot":"../../../src","sources":["utils/WavFileWriter.ts"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AAgBO,MAAMC,aAAa,CAAC;EAOjBC,QAAQ,GAAG,CAAC;EAEZC,SAAS,GAAG,KAAK;EAEjBC,UAAU,GAAiB,EAAE;EAErCC,WAAWA,CAACC,EAAmB,EAAEC,QAAgB,EAAEC,MAAqB,EAAE;IACxE,IAAI,CAACF,EAAE,GAAGA,EAAE;IACZ,IAAI,CAACC,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACC,MAAM,GAAGA,MAAM;EACtB;;EAEA;AACF;AACA;EACE,MAAMC,UAAUA,CAAA,EAAkB;IAChC,IAAI,IAAI,CAACN,SAAS,EAAE;MAClB;IACF;IAEA,IAAI;MACF;MACA,MAAMO,MAAM,GAAG,IAAI,CAACC,eAAe,CAAC,CAAC,CAAC;MACtC,MAAM,IAAI,CAACL,EAAE,CAACM,SAAS,CAAC,IAAI,CAACL,QAAQ,EAAE,IAAAM,0BAAkB,EAACH,MAAM,CAAC,EAAE,QAAQ,CAAC;MAE5E,IAAI,CAACR,QAAQ,GAAG,CAAC;MACjB,IAAI,CAACC,SAAS,GAAG,IAAI;MACrB,IAAI,CAACC,UAAU,GAAG,EAAE;IACtB,CAAC,CAAC,OAAOU,KAAK,EAAE;MACd,MAAM,IAAIC,KAAK,CAAE,kCAAiCD,KAAM,EAAC,CAAC;IAC5D;EACF;;EAEA;AACF;AACA;EACE,MAAME,eAAeA,CAACC,SAAqB,EAAiB;IAC1D,IAAI,CAAC,IAAI,CAACd,SAAS,EAAE;MACnB,MAAM,IAAIY,KAAK,CAAC,0BAA0B,CAAC;IAC7C;IAEA,IAAI;MACF;MACA,IAAI,CAACX,UAAU,CAACc,IAAI,CAACD,SAAS,CAAC;;MAE/B;MACA,MAAM,IAAI,CAACE,iBAAiB,EAAE;IAChC,CAAC,CAAC,OAAOL,KAAK,EAAE;MACdM,OAAO,CAACC,IAAI,CAAE,4CAA2CP,KAAM,EAAC,CAAC;IACnE;EACF;;EAEA;AACF;AACA;EACE,MAAcK,iBAAiBA,CAAA,EAAkB;IAC/C,IAAI,IAAI,CAACf,UAAU,CAACkB,MAAM,KAAK,CAAC,EAAE;MAChC;IACF;IAEA,IAAI;MACF;MACA,MAAMC,WAAW,GAAG,IAAI,CAACnB,UAAU,CAACoB,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,KAAKD,GAAG,GAAGC,IAAI,CAACJ,MAAM,EAAE,CAAC,CAAC;MAC/E,MAAMK,YAAY,GAAG,IAAIC,UAAU,CAACL,WAAW,CAAC;MAEhD,IAAIM,MAAM,GAAG,CAAC;MACd,IAAI,CAACzB,UAAU,CAAC0B,OAAO,CAACJ,IAAI,IAAI;QAC9BC,YAAY,CAACI,GAAG,CAAC,IAAIH,UAAU,CAACF,IAAI,CAAC,EAAEG,MAAM,CAAC;QAC9CA,MAAM,IAAIH,IAAI,CAACJ,MAAM;MACvB,CAAC,CAAC;;MAEF;MACA,MAAMU,UAAU,GAAG,IAAAnB,0BAAkB,EAACc,YAAY,CAAC;MACnD,MAAM,IAAI,CAACrB,EAAE,CAAC2B,UAAU,CAAC,IAAI,CAAC1B,QAAQ,EAAEyB,UAAU,EAAE,QAAQ,CAAC;;MAE7D;MACA,IAAI,CAAC9B,QAAQ,IAAIyB,YAAY,CAACL,MAAM;;MAEpC;MACA,IAAI,CAAClB,UAAU,GAAG,EAAE;IACtB,CAAC,CAAC,OAAOU,KAAK,EAAE;MACdM,OAAO,CAACC,IAAI,CAAE,sCAAqCP,KAAM,EAAC,CAAC;MAC3D;IACF;EACF;;EAEA;AACF;AACA;EACE,MAAMoB,QAAQA,CAAA,EAAkB;IAC9B,IAAI,CAAC,IAAI,CAAC/B,SAAS,EAAE;MACnB;IACF;IAEA,IAAI;MACF;MACA,MAAM,IAAI,CAACgB,iBAAiB,EAAE;;MAE9B;MACA,MAAMgB,WAAW,GAAG,MAAM,IAAI,CAAC7B,EAAE,CAAC8B,QAAQ,CAAC,IAAI,CAAC7B,QAAQ,EAAE,QAAQ,CAAC;MACnE,MAAM8B,YAAY,GAAG,IAAAC,0BAAkB,EAACH,WAAW,CAAC;;MAEpD;MACA,MAAMI,aAAa,GAAG,IAAI,CAAC5B,eAAe,CAAC,IAAI,CAACT,QAAQ,CAAC;;MAEzD;MACA,MAAMsC,SAAS,GAAG,IAAIZ,UAAU,CAACW,aAAa,CAACjB,MAAM,GAAG,IAAI,CAACpB,QAAQ,CAAC;MACtEsC,SAAS,CAACT,GAAG,CAACQ,aAAa,EAAE,CAAC,CAAC;MAC/BC,SAAS,CAACT,GAAG,CAACM,YAAY,CAACI,KAAK,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAC;;MAE1C;MACA,MAAMC,WAAW,GAAG,IAAA7B,0BAAkB,EAAC2B,SAAS,CAAC;MACjD,MAAM,IAAI,CAAClC,EAAE,CAACM,SAAS,CAAC,IAAI,CAACL,QAAQ,EAAEmC,WAAW,EAAE,QAAQ,CAAC;MAE7D,IAAI,CAACvC,SAAS,GAAG,KAAK;IACxB,CAAC,CAAC,OAAOW,KAAK,EAAE;MACdM,OAAO,CAACC,IAAI,CAAE,gCAA+BP,KAAM,EAAC,CAAC;IACvD;EACF;;EAEA;AACF;AACA;EACUH,eAAeA,CAACT,QAAgB,EAAc;IACpD,MAAMQ,MAAM,GAAG,IAAIiC,WAAW,CAAC,EAAE,CAAC;IAClC,MAAMC,IAAI,GAAG,IAAIC,QAAQ,CAACnC,MAAM,CAAC;;IAEjC;IACAkC,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,UAAU,EAAE,KAAK,CAAC,EAAC;IACrCF,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,EAAE,GAAG5C,QAAQ,EAAE,IAAI,CAAC,EAAC;IACvC0C,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,UAAU,EAAE,KAAK,CAAC,EAAC;;IAErC;IACAF,IAAI,CAACE,SAAS,CAAC,EAAE,EAAE,UAAU,EAAE,KAAK,CAAC,EAAC;IACtCF,IAAI,CAACE,SAAS,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,EAAC;IAC7BF,IAAI,CAACG,SAAS,CAAC,EAAE,EAAE,CAAC,EAAE,IAAI,CAAC,EAAC;IAC5BH,IAAI,CAACG,SAAS,CAAC,EAAE,EAAE,IAAI,CAACvC,MAAM,CAACwC,QAAQ,EAAE,IAAI,CAAC,EAAC;IAC/CJ,IAAI,CAACE,SAAS,CAAC,EAAE,EAAE,IAAI,CAACtC,MAAM,CAACyC,UAAU,EAAE,IAAI,CAAC,EAAC;IACjDL,IAAI,CAACE,SAAS,CAAC,EAAE,EAAE,IAAI,CAACtC,MAAM,CAACyC,UAAU,GAAG,IAAI,CAACzC,MAAM,CAACwC,QAAQ,IAAI,IAAI,CAACxC,MAAM,CAAC0C,aAAa,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,EAAC;IAC1GN,IAAI,CAACG,SAAS,CAAC,EAAE,EAAE,IAAI,CAACvC,MAAM,CAACwC,QAAQ,IAAI,IAAI,CAACxC,MAAM,CAAC0C,aAAa,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,EAAC;IACjFN,IAAI,CAACG,SAAS,CAAC,EAAE,EAAE,IAAI,CAACvC,MAAM,CAAC0C,aAAa,EAAE,IAAI,CAAC,EAAC;;IAEpD;IACAN,IAAI,CAACE,SAAS,CAAC,EAAE,EAAE,UAAU,EAAE,KAAK,CAAC,EAAC;IACtCF,IAAI,CAACE,SAAS,CAAC,EAAE,EAAE5C,QAAQ,EAAE,IAAI,CAAC,EAAC;;IAEnC,OAAO,IAAI0B,UAAU,CAAClB,MAAM,CAAC;EAC/B;;EAEA;AACF;AACA;EACE,MAAMyC,MAAMA,CAAA,EAAkB;IAC5B,IAAI,CAAChD,SAAS,GAAG,KAAK;IACtB,IAAI,CAACC,UAAU,GAAG,EAAE;IAEpB,IAAI;MACF;MACA,MAAMgD,MAAM,GAAG,MAAM,IAAI,CAAC9C,EAAE,CAAC8C,MAAM,CAAC,IAAI,CAAC7C,QAAQ,CAAC;MAClD,IAAI6C,MAAM,EAAE;QACV,MAAM,IAAI,CAAC9C,EAAE,CAAC+C,MAAM,CAAC,IAAI,CAAC9C,QAAQ,CAAC;MACrC;IACF,CAAC,CAAC,OAAOO,KAAK,EAAE;MACdM,OAAO,CAACC,IAAI,CAAE,+BAA8BP,KAAM,EAAC,CAAC;IACtD;EACF;;EAEA;AACF;AACA;EACEwC,aAAaA,CAAA,EAAG;IACd,MAAMC,WAAW,GAAG,IAAI,CAACrD,QAAQ,IAAI,IAAI,CAACM,MAAM,CAACyC,UAAU,GAAG,IAAI,CAACzC,MAAM,CAACwC,QAAQ,IAAI,IAAI,CAACxC,MAAM,CAAC0C,aAAa,GAAG,CAAC,CAAC,CAAC;IAErH,OAAO;MACL3C,QAAQ,EAAE,IAAI,CAACA,QAAQ;MACvBL,QAAQ,EAAE,IAAI,CAACA,QAAQ;MACvBqD,WAAW;MACXpD,SAAS,EAAE,IAAI,CAACA,SAAS;MACzBqD,YAAY,EAAE,IAAI,CAACpD,UAAU,CAACkB,MAAM;MACpCmC,mBAAmB,EAAE,CAAC,EAAE,GAAG,IAAI,CAACvD,QAAQ,KAAK,IAAI,GAAG,IAAI;IAC1D,CAAC;EACH;AACF;AAACwD,OAAA,CAAAzD,aAAA,GAAAA,aAAA"}