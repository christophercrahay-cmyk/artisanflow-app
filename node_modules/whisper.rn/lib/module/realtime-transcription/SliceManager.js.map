{"version":3,"names":["SliceManager","slices","currentSliceIndex","transcribeSliceIndex","constructor","sliceDurationSec","arguments","length","undefined","maxSlicesInMemory","sampleRate","addAudioData","audioData","currentSlice","getCurrentSlice","bytesPerSlice","sampleCount","finalizeCurrentSlice","newData","Uint8Array","set","data","subarray","endTime","Date","now","isSliceComplete","slice","find","s","index","startTime","isProcessed","isReleased","push","cleanupOldSlices","getSliceForTranscription","markSliceAsProcessed","sliceIndex","moveToNextTranscribeSlice","getAudioDataForTranscription","getSliceByIndex","sort","a","b","slicesToKeep","slicesToRemove","forEach","getMemoryUsage","activeSlices","filter","totalBytes","reduce","sum","estimatedMB","slicesInMemory","totalSamples","Math","round","reset","getCurrentSliceInfo","totalSlices","memoryUsage","forceNextSlice"],"sourceRoot":"../../../src","sources":["realtime-transcription/SliceManager.ts"],"mappings":"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"}