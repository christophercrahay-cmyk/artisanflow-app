{"version":3,"names":["base64ToUint8Array","uint8ArrayToBase64","WavFileWriter","dataSize","isWriting","writeQueue","constructor","fs","filePath","config","initialize","header","createWavHeader","writeFile","error","Error","appendAudioData","audioData","push","processWriteQueue","console","warn","length","totalLength","reduce","sum","data","combinedData","Uint8Array","offset","forEach","set","base64Data","appendFile","finalize","currentData","readFile","currentBytes","correctHeader","finalData","slice","finalBase64","ArrayBuffer","view","DataView","setUint32","setUint16","channels","sampleRate","bitsPerSample","cancel","exists","unlink","getStatistics","durationSec","queuedChunks","estimatedFileSizeMB"],"sourceRoot":"../../../src","sources":["utils/WavFileWriter.ts"],"mappings":"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"}